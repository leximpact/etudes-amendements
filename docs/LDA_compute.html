---

title: Etude des sujets des amendements PLFSS (LDA)


keywords: fastai
sidebar: home_sidebar



nb_path: "notebook/03_LDA_compute.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebook/03_LDA_compute.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">amdt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/amdt_sans_stopword.csv.gz&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Analyse-des-th&#233;matiques-par-LDA">Analyse des th&#233;matiques par LDA<a class="anchor-link" href="#Analyse-des-th&#233;matiques-par-LDA"> </a></h1><p>LDA : <a href="https://fr.wikipedia.org/wiki/Allocation_de_Dirichlet_latente">https://fr.wikipedia.org/wiki/Allocation_de_Dirichlet_latente</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">LatentDirichletAllocation</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
 
<span class="n">NUM_TOPICS</span> <span class="o">=</span> <span class="mi">15</span>
 
<span class="c1"># vectorizer = CountVectorizer(min_df=5, max_df=0.9, </span>
<span class="c1">#                              stop_words=&#39;french&#39;, lowercase=True, </span>
<span class="c1">#                              token_pattern=&#39;[a-zA-Z\-][a-zA-Z\-]{2,}&#39;)</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">data_vectorized</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">amdt</span><span class="p">[</span><span class="s2">&quot;txt_sans_stopword&quot;</span><span class="p">])</span>
 
<span class="c1"># Build a Latent Dirichlet Allocation Model</span>
<span class="c1"># n_jobs = -1 to use all CPU core</span>
<span class="n">lda_model</span> <span class="o">=</span> <span class="n">LatentDirichletAllocation</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">NUM_TOPICS</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">learning_method</span><span class="o">=</span><span class="s1">&#39;online&#39;</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lda_Z</span> <span class="o">=</span> <span class="n">lda_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_vectorized</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Define Search Param</span>
<span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_components&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
                <span class="s1">&#39;learning_decay&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">5</span><span class="p">],</span> <span class="c1"># [.5, .7, .9]</span>
                <span class="s1">&#39;max_iter&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                <span class="s1">&#39;learning_method&#39;</span><span class="p">:[</span><span class="s1">&#39;online&#39;</span><span class="p">],</span>
                <span class="s1">&#39;n_jobs&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>

<span class="c1"># Init the Model</span>
<span class="n">lda</span> <span class="o">=</span> <span class="n">LatentDirichletAllocation</span><span class="p">()</span>

<span class="c1"># Init Grid Search Class</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>

<span class="c1"># Do the Grid Search</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_vectorized</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(estimator=LatentDirichletAllocation(),
             param_grid={&#39;learning_decay&#39;: [0.5], &#39;learning_method&#39;: [&#39;online&#39;],
                         &#39;max_iter&#39;: [10], &#39;n_components&#39;: [3],
                         &#39;n_jobs&#39;: [-1]})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_lda_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="c1"># Model Parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Model&#39;s Params: &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1"># Log Likelihood Score</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Log Likelihood Score: &quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">best_score_</span><span class="p">)</span>

<span class="c1"># Perplexity</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model Perplexity: &quot;</span><span class="p">,</span> <span class="n">best_lda_model</span><span class="o">.</span><span class="n">perplexity</span><span class="p">(</span><span class="n">data_vectorized</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Best Model&#39;s Params:  {&#39;learning_decay&#39;: 0.5, &#39;learning_method&#39;: &#39;online&#39;, &#39;max_iter&#39;: 10, &#39;n_components&#39;: 3, &#39;n_jobs&#39;: -1}
Best Log Likelihood Score:  -21229.415783180353
Model Perplexity:  2248.6663320542257
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">cv_results_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;mean_fit_time&#39;: array([0.38533525]),
 &#39;std_fit_time&#39;: array([0.01228836]),
 &#39;mean_score_time&#39;: array([0.02309036]),
 &#39;std_score_time&#39;: array([0.00309237]),
 &#39;param_learning_decay&#39;: masked_array(data=[0.5],
              mask=[False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_learning_method&#39;: masked_array(data=[&#39;online&#39;],
              mask=[False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_max_iter&#39;: masked_array(data=[10],
              mask=[False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_n_components&#39;: masked_array(data=[3],
              mask=[False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_n_jobs&#39;: masked_array(data=[-1],
              mask=[False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;learning_decay&#39;: 0.5,
   &#39;learning_method&#39;: &#39;online&#39;,
   &#39;max_iter&#39;: 10,
   &#39;n_components&#39;: 3,
   &#39;n_jobs&#39;: -1}],
 &#39;split0_test_score&#39;: array([-18425.07818445]),
 &#39;split1_test_score&#39;: array([-21359.64711255]),
 &#39;split2_test_score&#39;: array([-20499.78328675]),
 &#39;split3_test_score&#39;: array([-20304.64253598]),
 &#39;split4_test_score&#39;: array([-25557.92779617]),
 &#39;mean_test_score&#39;: array([-21229.41578318]),
 &#39;std_test_score&#39;: array([2366.63706352]),
 &#39;rank_test_score&#39;: array([1], dtype=int32)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># n_topics = [10, 15, 20, 25, 30]</span>
<span class="c1"># log_likelyhoods_5 = [round(gscore.mean_validation_score) for gscore in model.grid_scores_ if gscore.parameters[&#39;learning_decay&#39;]==0.5]</span>
<span class="c1"># log_likelyhoods_7 = [round(gscore.mean_validation_score) for gscore in model.grid_scores_ if gscore.parameters[&#39;learning_decay&#39;]==0.7]</span>
<span class="c1"># log_likelyhoods_9 = [round(gscore.mean_validation_score) for gscore in model.grid_scores_ if gscore.parameters[&#39;learning_decay&#39;]==0.9]</span>

<span class="c1"># # Show graph</span>
<span class="c1"># plt.figure(figsize=(12, 8))</span>
<span class="c1"># plt.plot(n_topics, log_likelyhoods_5, label=&#39;0.5&#39;)</span>
<span class="c1"># plt.plot(n_topics, log_likelyhoods_7, label=&#39;0.7&#39;)</span>
<span class="c1"># plt.plot(n_topics, log_likelyhoods_9, label=&#39;0.9&#39;)</span>
<span class="c1"># plt.title(&quot;Choosing Optimal LDA Model&quot;)</span>
<span class="c1"># plt.xlabel(&quot;Num Topics&quot;)</span>
<span class="c1"># plt.ylabel(&quot;Log Likelyhood Scores&quot;)</span>
<span class="c1"># plt.legend(title=&#39;Learning decay&#39;, loc=&#39;best&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="How-to-see-the-dominant-topic-in-each-document?">How to see the dominant topic in each document?<a class="anchor-link" href="#How-to-see-the-dominant-topic-in-each-document?"> </a></h1><p>To classify a document as belonging to a particular topic, a logical approach is to see which topic has the highest contribution to that document and assign it.</p>
<p>In the table below, I’ve greened out all major topics in a document and assigned the most dominant topic in its own column.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_lda_model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LatentDirichletAllocation(learning_decay=0.5, learning_method=&#39;online&#39;,
                          n_components=3, n_jobs=-1)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Create Document - Topic Matrix</span>
<span class="n">lda_output</span> <span class="o">=</span> <span class="n">best_lda_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_vectorized</span><span class="p">)</span>

<span class="c1"># column names</span>
<span class="n">topicnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Topic&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">best_lda_model</span><span class="o">.</span><span class="n">n_components</span><span class="p">)]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">amdt</span><span class="p">[</span><span class="s2">&quot;txt_sans_stopword&quot;</span><span class="p">]</span>
<span class="c1"># index names</span>
<span class="n">docnames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Doc&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))]</span>

<span class="c1"># Make the pandas dataframe</span>
<span class="n">df_document_topic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lda_output</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">topicnames</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">docnames</span><span class="p">)</span>

<span class="c1"># Get dominant topic for each document</span>
<span class="n">dominant_topic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">df_document_topic</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_document_topic</span><span class="p">[</span><span class="s1">&#39;dominant_topic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dominant_topic</span>

<span class="c1"># Styling</span>
<span class="k">def</span> <span class="nf">color_green</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;black&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;color: </span><span class="si">{col}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_bold</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="mi">700</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">400</span>
    <span class="k">return</span> <span class="s1">&#39;font-weight: </span><span class="si">{weight}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">)</span>

<span class="c1"># Apply Style</span>
<span class="n">df_document_topics</span> <span class="o">=</span> <span class="n">df_document_topic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">color_green</span><span class="p">)</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">make_bold</span><span class="p">)</span>
<span class="n">df_document_topics</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style  type="text/css" >
#T_961c9_row0_col0,#T_961c9_row0_col1,#T_961c9_row1_col1,#T_961c9_row1_col2,#T_961c9_row1_col3,#T_961c9_row2_col0,#T_961c9_row2_col1,#T_961c9_row3_col0,#T_961c9_row3_col2,#T_961c9_row4_col0,#T_961c9_row4_col1,#T_961c9_row5_col0,#T_961c9_row5_col2,#T_961c9_row6_col0,#T_961c9_row6_col1,#T_961c9_row7_col0,#T_961c9_row7_col1,#T_961c9_row8_col0,#T_961c9_row8_col1,#T_961c9_row9_col0,#T_961c9_row9_col2,#T_961c9_row10_col0,#T_961c9_row11_col0,#T_961c9_row11_col2,#T_961c9_row12_col0,#T_961c9_row12_col2,#T_961c9_row13_col0,#T_961c9_row13_col2,#T_961c9_row14_col1,#T_961c9_row14_col2,#T_961c9_row14_col3{
            color:  black;
            font-weight:  400;
        }#T_961c9_row0_col2,#T_961c9_row0_col3,#T_961c9_row1_col0,#T_961c9_row2_col2,#T_961c9_row2_col3,#T_961c9_row3_col1,#T_961c9_row3_col3,#T_961c9_row4_col2,#T_961c9_row4_col3,#T_961c9_row5_col1,#T_961c9_row5_col3,#T_961c9_row6_col2,#T_961c9_row6_col3,#T_961c9_row7_col2,#T_961c9_row7_col3,#T_961c9_row8_col2,#T_961c9_row8_col3,#T_961c9_row9_col1,#T_961c9_row9_col3,#T_961c9_row10_col1,#T_961c9_row10_col2,#T_961c9_row10_col3,#T_961c9_row11_col1,#T_961c9_row11_col3,#T_961c9_row12_col1,#T_961c9_row12_col3,#T_961c9_row13_col1,#T_961c9_row13_col3,#T_961c9_row14_col0{
            color:  green;
            font-weight:  700;
        }</style><table id="T_961c9_" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Topic0</th>        <th class="col_heading level0 col1" >Topic1</th>        <th class="col_heading level0 col2" >Topic2</th>        <th class="col_heading level0 col3" >dominant_topic</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_961c9_level0_row0" class="row_heading level0 row0" >Doc0</th>
                        <td id="T_961c9_row0_col0" class="data row0 col0" >0.040000</td>
                        <td id="T_961c9_row0_col1" class="data row0 col1" >0.040000</td>
                        <td id="T_961c9_row0_col2" class="data row0 col2" >0.910000</td>
                        <td id="T_961c9_row0_col3" class="data row0 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row1" class="row_heading level0 row1" >Doc1</th>
                        <td id="T_961c9_row1_col0" class="data row1 col0" >0.990000</td>
                        <td id="T_961c9_row1_col1" class="data row1 col1" >0.000000</td>
                        <td id="T_961c9_row1_col2" class="data row1 col2" >0.000000</td>
                        <td id="T_961c9_row1_col3" class="data row1 col3" >0</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row2" class="row_heading level0 row2" >Doc2</th>
                        <td id="T_961c9_row2_col0" class="data row2 col0" >0.010000</td>
                        <td id="T_961c9_row2_col1" class="data row2 col1" >0.010000</td>
                        <td id="T_961c9_row2_col2" class="data row2 col2" >0.980000</td>
                        <td id="T_961c9_row2_col3" class="data row2 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row3" class="row_heading level0 row3" >Doc3</th>
                        <td id="T_961c9_row3_col0" class="data row3 col0" >0.010000</td>
                        <td id="T_961c9_row3_col1" class="data row3 col1" >0.990000</td>
                        <td id="T_961c9_row3_col2" class="data row3 col2" >0.010000</td>
                        <td id="T_961c9_row3_col3" class="data row3 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row4" class="row_heading level0 row4" >Doc4</th>
                        <td id="T_961c9_row4_col0" class="data row4 col0" >0.000000</td>
                        <td id="T_961c9_row4_col1" class="data row4 col1" >0.000000</td>
                        <td id="T_961c9_row4_col2" class="data row4 col2" >1.000000</td>
                        <td id="T_961c9_row4_col3" class="data row4 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row5" class="row_heading level0 row5" >Doc5</th>
                        <td id="T_961c9_row5_col0" class="data row5 col0" >0.010000</td>
                        <td id="T_961c9_row5_col1" class="data row5 col1" >0.970000</td>
                        <td id="T_961c9_row5_col2" class="data row5 col2" >0.020000</td>
                        <td id="T_961c9_row5_col3" class="data row5 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row6" class="row_heading level0 row6" >Doc6</th>
                        <td id="T_961c9_row6_col0" class="data row6 col0" >0.000000</td>
                        <td id="T_961c9_row6_col1" class="data row6 col1" >0.000000</td>
                        <td id="T_961c9_row6_col2" class="data row6 col2" >0.990000</td>
                        <td id="T_961c9_row6_col3" class="data row6 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row7" class="row_heading level0 row7" >Doc7</th>
                        <td id="T_961c9_row7_col0" class="data row7 col0" >0.010000</td>
                        <td id="T_961c9_row7_col1" class="data row7 col1" >0.010000</td>
                        <td id="T_961c9_row7_col2" class="data row7 col2" >0.980000</td>
                        <td id="T_961c9_row7_col3" class="data row7 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row8" class="row_heading level0 row8" >Doc8</th>
                        <td id="T_961c9_row8_col0" class="data row8 col0" >0.010000</td>
                        <td id="T_961c9_row8_col1" class="data row8 col1" >0.010000</td>
                        <td id="T_961c9_row8_col2" class="data row8 col2" >0.980000</td>
                        <td id="T_961c9_row8_col3" class="data row8 col3" >2</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row9" class="row_heading level0 row9" >Doc9</th>
                        <td id="T_961c9_row9_col0" class="data row9 col0" >0.000000</td>
                        <td id="T_961c9_row9_col1" class="data row9 col1" >0.990000</td>
                        <td id="T_961c9_row9_col2" class="data row9 col2" >0.000000</td>
                        <td id="T_961c9_row9_col3" class="data row9 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row10" class="row_heading level0 row10" >Doc10</th>
                        <td id="T_961c9_row10_col0" class="data row10 col0" >0.010000</td>
                        <td id="T_961c9_row10_col1" class="data row10 col1" >0.520000</td>
                        <td id="T_961c9_row10_col2" class="data row10 col2" >0.480000</td>
                        <td id="T_961c9_row10_col3" class="data row10 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row11" class="row_heading level0 row11" >Doc11</th>
                        <td id="T_961c9_row11_col0" class="data row11 col0" >0.000000</td>
                        <td id="T_961c9_row11_col1" class="data row11 col1" >0.990000</td>
                        <td id="T_961c9_row11_col2" class="data row11 col2" >0.000000</td>
                        <td id="T_961c9_row11_col3" class="data row11 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row12" class="row_heading level0 row12" >Doc12</th>
                        <td id="T_961c9_row12_col0" class="data row12 col0" >0.000000</td>
                        <td id="T_961c9_row12_col1" class="data row12 col1" >1.000000</td>
                        <td id="T_961c9_row12_col2" class="data row12 col2" >0.000000</td>
                        <td id="T_961c9_row12_col3" class="data row12 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row13" class="row_heading level0 row13" >Doc13</th>
                        <td id="T_961c9_row13_col0" class="data row13 col0" >0.000000</td>
                        <td id="T_961c9_row13_col1" class="data row13 col1" >0.990000</td>
                        <td id="T_961c9_row13_col2" class="data row13 col2" >0.000000</td>
                        <td id="T_961c9_row13_col3" class="data row13 col3" >1</td>
            </tr>
            <tr>
                        <th id="T_961c9_level0_row14" class="row_heading level0 row14" >Doc14</th>
                        <td id="T_961c9_row14_col0" class="data row14 col0" >0.990000</td>
                        <td id="T_961c9_row14_col1" class="data row14 col1" >0.000000</td>
                        <td id="T_961c9_row14_col2" class="data row14 col2" >0.000000</td>
                        <td id="T_961c9_row14_col3" class="data row14 col3" >0</td>
            </tr>
    </tbody></table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Review-topics-distribution-across-documents">Review topics distribution across documents<a class="anchor-link" href="#Review-topics-distribution-across-documents"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_topic_distribution</span> <span class="o">=</span> <span class="n">df_document_topic</span><span class="p">[</span><span class="s1">&#39;dominant_topic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
<span class="n">df_topic_distribution</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Topic Num&#39;</span><span class="p">,</span> <span class="s1">&#39;Num Documents&#39;</span><span class="p">]</span>
<span class="n">df_topic_distribution</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Topic Num</th>
      <th>Num Documents</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>47</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Affecter-un-sujet-&#224;-un-texte-en-utilisant-le-mod&#232;le">Affecter un sujet &#224; un texte en utilisant le mod&#232;le<a class="anchor-link" href="#Affecter-un-sujet-&#224;-un-texte-en-utilisant-le-mod&#232;le"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Pour les entreprises de moins de 11 salariés, l’employeur est autorisé à attribuer une fois par an, à l’ensemble des salariés qu’il emploie, la prime exceptionnelle de pouvoir d’achat, dans les conditions prévues au V. »II. – En conséquence, compléter cet article par les deux alinéas suivants&quot;</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">lda_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="n">text</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.00185185 0.00185185 0.00185186 0.00185185 0.00185185 0.1337625
 0.41106784 0.11301411 0.00185185 0.00185185 0.00185186 0.00185186
 0.00185185 0.00185186 0.32178515] 0.9999999999999998
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lda_Z</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(100, 15)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lda_Z</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.00740741, 0.00740741, 0.00740741, 0.00740741, 0.00740741,
        0.00740743, 0.00740741, 0.89629623, 0.00740741, 0.00740741,
        0.00740741, 0.00740741, 0.00740741, 0.00740741, 0.00740742]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">vectorizer</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;./data/amdt_vectorizer.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">data_vectorized</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;./data/amdt_data_vectorized.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">lda_model</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;./data/amdt_lda_model.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">lda_Z</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;./data/amdt_lda_Z.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

