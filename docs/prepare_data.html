---

title: Etude des sujets des amendements PLFSS


keywords: fastai
sidebar: home_sidebar



nb_path: "notebook/01_prepare_data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebook/01_prepare_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#amdt = pd.read_csv(&#39;../../../donnees-extraites-assemblee/textes_amendements_nouveaux_articles_plfss_2020-2021.csv&#39;)</span>
<span class="n">amdt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://github.com/leximpact/donnees-extraites-assemblee/raw/main/textes_amendements_nouveaux_articles_plfss_2020-2021.csv&#39;</span><span class="p">)</span>
<span class="n">amdt</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>texteLegislatifUid</th>
      <th>uid</th>
      <th>avantAApres</th>
      <th>dispositif</th>
      <th>exposeSommaire</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PRJLANR5L15B2296</td>
      <td>AMANR5L15PO420120B2296P0D1N000001</td>
      <td>A</td>
      <td>I. – Après l’alinéa 13, insérer l’alinéa suiv...</td>
      <td>La mise en place d’un accord d’intéressement d...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">amdt</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4797</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;texte&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;dispositif&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;exposeSommaire&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Nettoyage">Nettoyage<a class="anchor-link" href="#Nettoyage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Retrait-des-mots-de-liaison-(stopword)-et-de-la-ponctuation">Retrait des mots de liaison (<em>stopword</em>) et de la ponctuation<a class="anchor-link" href="#Retrait-des-mots-de-liaison-(stopword)-et-de-la-ponctuation"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="s2">&quot;Bonjour Madame Marianne et Monsieur Coq,</span><span class="se">\n</span><span class="s2"> Comment allez-vous ?&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bonjour Madame Marianne et Monsieur Coq,
 Comment allez-vous ?
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spacy</span>
<span class="c1">#from spacy.lang.fr.stop_words import STOP_WORDS as fr_stop</span>
<span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;fr_core_news_sm&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">return_token</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
    <span class="c1"># Tokeniser la phrase</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
    <span class="c1"># Retourner le texte de chaque token</span>
    <span class="c1">#print(doc[4].pos_)</span>
    <span class="c1"># Retire la ponctuation et les retours à la ligne</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">doc</span> <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">is</span> <span class="kc">False</span> <span class="o">|</span> <span class="n">X</span><span class="o">.</span><span class="n">is_space</span> <span class="ow">is</span> <span class="kc">False</span> <span class="o">|</span> <span class="n">X</span><span class="o">.</span><span class="n">is_stop</span> <span class="ow">is</span> <span class="kc">False</span> <span class="p">]</span>
<span class="n">test_token</span> <span class="o">=</span> <span class="n">return_token</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="n">test_token</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Bonjour&#39;, &#39;Madame&#39;, &#39;Marianne&#39;, &#39;Monsieur&#39;, &#39;Coq&#39;, &#39;allez&#39;, &#39;-vous&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_words</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">str_token</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">data_words</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">return_token</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">data_words</span> <span class="o">+=</span> <span class="n">tokens</span>
    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>

<span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;txt_sans_stopword&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;texte&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">str_token</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data_words</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>566051</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">data_words</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;./data/amdt_data_words.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">amdt</span><span class="p">[</span><span class="s1">&#39;txt_sans_stopword&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./data/amdt_sans_stopword.csv.gz&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="WIP-:-Les-entites-les-plus-cit&#233;s">WIP : Les entites les plus cit&#233;s<a class="anchor-link" href="#WIP-:-Les-entites-les-plus-cit&#233;s"> </a></h1><p>Spacy permet d'extraire les nom de personne, de lieu, les dates, cela pourrait servir...</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bonjour Madame Marianne 0 23 PER
Monsieur Coq 27 39 PER
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

